establish_protectorate = {
	category = influence
	
	alert_index = 4
	alert_tooltip = establish_protectorate_alert_tooltip
	
	require_acceptance = yes
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = protectorate
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = protectorate
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = protectorate
			}
			if = {
				limit = {
					any_country = {
						is_subject_of = FROM
						is_colonial_nation = no
					}
				}
				every_country = {
					limit = {
						is_subject_of = FROM
						is_colonial_nation = no
					}
					FROM = {
						PREV = { grant_independence = yes }
					}
				}
			}
		}
	}
	
	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_protectorate_@ROOT
				set_country_flag = declined_establish_protectorate_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_protectorate_opinion
			}
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 0 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 100 } }
					has_opinion = { who = ROOT value = 0 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
			export_to_variable = {
				variable_name = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value_2 value = 4 }
			change_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					has_opinion = { who = ROOT value = 100 }
				}
			}
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 8 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 1 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 2 } }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 2 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 3 } }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 3 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 4 } }
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 4 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 5 } }
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 5 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 6 } }
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 6 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 7 } }
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 7 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 8 } }
			}
			export_to_variable = {
				which = ai_value
				value = 70
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 8 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 9 } }
			}
			export_to_variable = {
				which = ai_value
				value = 80
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 9 }
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 10 } }
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NUM_OF_PROTECTORATES
			limit = {
				calc_true_if = { all_subject_country = { is_subject_of_type = protectorate } amount = 10 }
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_TOTAL_DEVELOPMENT_OVER_200
			limit = {
				FROM = { total_development = 200 }
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				any_country = {
					is_subject_of = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = trigger_value:mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = trigger_value:mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			total_development = 70
			NOT = { total_development = 200 }
			OR = {
				NOT = { has_country_flag = declined_establish_protectorate_@ROOT }
				had_country_flag = { flag = declined_establish_protectorate_@ROOT days = 1825 }
			}
			NOT = { adm_tech = ROOT }
			NOT = { dip_tech = ROOT }
			NOT = { mil_tech = ROOT }
		}
		institution_difference = { who = FROM value = 1 }
		has_opinion = { who = FROM value = 50 }
		OR = {
			ai_attitude = { who = FROM attitude = attitude_friendly }
			ai_attitude = { who = FROM attitude = attitude_allied }
			ai_attitude = { who = FROM attitude = attitude_neutral }
		}
		OR = {
			NOT = { has_casus_belli_against = FROM }
			FROM = {
				NOT = {
					num_of_owned_provinces_with = {
						value = 3
						OR = {
							is_claim = ROOT
							is_core = ROOT
							any_country = {
								is_subject_of = ROOT
								PREV = { is_claim = PREV }
							}
							any_country = {
								is_subject_of = ROOT
								PREV = { is_core = PREV }
							}
						}
					}
				}
			}
		}
	}
}

ask_to_become_protectorate = {
	category = influence
	
	alert_index = 4
	alert_tooltip = ask_to_become_protectorate_alert_tooltip
	
	require_acceptance = yes
	
	is_visible = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = protectorate
			}
		}
	}
	
	is_allowed = {
		FROM = {
			can_create_subject_type = {
				subject = ROOT
				subject_type = protectorate
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		capital_scope = { trade_range = FROM }
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = protectorate
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			FROM = {
				create_subject = {
					subject = ROOT
					subject_type = protectorate
				}
			}
			if = {
				limit = {
					any_country = {
						is_subject_of = ROOT
						is_colonial_nation = no
					}
				}
				every_country = {
					limit = {
						is_subject_of = ROOT
						is_colonial_nation = no
					}
					ROOT = {
						PREV = { grant_independence = yes }
					}
				}
			}
		}
	}
	
	on_decline = {
		if = {
			limit = {
				FROM = {
					can_create_subject_type = {
						subject = ROOT
						subject_type = protectorate
					}
				}
				is_at_war = no
				FROM = { is_at_war = no }
				capital_scope = { trade_range = FROM }
			}
			FROM = {
				clr_country_flag = declined_become_protectorate_@ROOT
				set_country_flag = declined_become_protectorate_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_ask_to_become_protectorate
			}
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 0 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					NOT = { has_opinion = { who = ROOT value = 100 } }
					has_opinion = { who = ROOT value = 0 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
			export_to_variable = {
				variable_name = ai_value_2
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value_2 value = 4 }
			change_variable = { which = ai_value which = ai_value_2 }
		}
		add_entry = {
			name = OPINION
			limit = {
				FROM = {
					has_opinion = { who = ROOT value = 100 }
				}
			}
			export_to_variable = {
				variable_name = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 8 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_domineering }
						ai_attitude = { who = ROOT attitude = attitude_protective }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10000
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_allied }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					NOT = { check_variable = { which = military_power value = -349 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 350
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = -349 }
					NOT = { check_variable = { which = military_power value = 60 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = trigger_value:mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = trigger_value:mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = 60 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = -349 }
					NOT = { check_variable = { which = eco_power value = 60 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					NOT = { check_variable = { which = eco_power value = -349 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 350
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = 60 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
	}
	
	ai_will_do = {
		total_development = 70
		NOT = { total_development = 200 }
		NOT = { adm_tech = FROM }
		NOT = { dip_tech = FROM }
		NOT = { mil_tech = FROM }
		NOT = { num_of_subjects = 1 }
		has_opinion = { who = FROM value = 50 }
		FROM = { 
			OR = {
				NOT = { has_country_flag = declined_become_protectorate_@ROOT }
				had_country_flag = { flag = declined_become_protectorate_@ROOT days = 1825 }
			}
			institution_difference = { who = ROOT value = 1 }
			OR = {
				ai_attitude = { who = ROOT attitude = attitude_friendly }
				ai_attitude = { who = ROOT attitude = attitude_allied }
				ai_attitude = { who = ROOT attitude = attitude_neutral }
				ai_attitude = { who = ROOT attitude = attitude_threatened }
			}
			OR = {
				NOT = { has_casus_belli_against = ROOT }
				ROOT = {
					NOT = {
						num_of_owned_provinces_with = {
							value = 3
							OR = {
								is_claim = FROM
								is_core = FROM
								any_country = {
									is_subject_of = FROM
									PREV = { is_claim = PREV }
								}
								any_country = {
									is_subject_of = FROM
									PREV = { is_core = PREV }
								}
							}
						}
					}
				}
			}
		}
	}
}

cancel_protectorate = {
	category = influence
	
	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = protectorate
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = protectorate
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { truce_with = FROM }
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = protectorate
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { truce_with = FROM }
			}
			if = {
				limit = {
					NOT = { full_idea_group = diplomatic_ideas }
				}
				add_stability = -1
			}
			FROM = {
				grant_independence = yes
				country_event = { id = subjects_expanded_protectorate_events.2 }
				add_opinion = {
					who = ROOT
					modifier = released_protectorate
				}
			}
		}
	}
	ai_will_do = {
		OR = {
			stability = 2
			adm_power = 300
			full_idea_group = diplomatic_ideas
		}
		OR = {
			AND = {
				FROM = {
					all_owned_province = {
						all_neighbor_province = {
							OR = {
								owned_by = FROM
								owned_by = ROOT
								owner = {
									is_subject_of = ROOT
									NOT = { liberty_desire = 50 }
								}
							}
						}
					}
				}
				has_casus_belli_against = FROM
			}
			AND = {
				FROM = { liberty_desire = 80 }
				NOT = {
					calc_true_if = {
						all_province = {
							OR = {
								owned_by = ROOT
								owner = {
									NOT = { tag = FROM }
									is_subject_of = ROOT
								}
							}
							same_continent = FROM
						}
						amount = 15
					}
				}
				OR = {
					is_year = 1800
					current_age = age_of_revolutions
				}
			}
		}
	}
}

establish_puppet_state = {
	category = influence
	
	alert_index = 6
	alert_tooltip = establish_puppet_state_alert_tooltip
	
	require_acceptance = yes
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = puppet_state
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = puppet_state
		}
		prestige = 0
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		FROM = {
			NOT = { total_development = 300 }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = puppet_state
				}
				prestige = 0
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				FROM = {
					NOT = { total_development = 300 }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = puppet_state
			}
			FROM = {
				country_event = { id = subjects_expanded_puppet_state_events.1 }
			}
		}
	}
	
	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = puppet_state
				}
				prestige = 0
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				FROM = {
					NOT = { total_development = 300 }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_puppet_state_@ROOT
				set_country_flag = declined_establish_puppet_state_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_puppet_state_opinion
			}
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = FROM_IS_SUBJECT_AT_RIVAL_BORDER
			limit = {
				FROM = {
					is_subject_of = ROOT
				}
				OR = {
					any_rival_country = {
						is_neighbor_of = FROM
					}
					any_enemy_country = {
						is_neighbor_of = FROM
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_MONARCHY
			limit = {
				FROM = {
					government = monarchy
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_OTHER_IDEOLOGY
			limit = {
				OR = {
					# Fascist Government Type
					AND = {
						OR = {
							has_reform = fascist_government
							has_reform = military_government
							has_reform = presidential_despot_reform
						}
						FROM = {
							NOT = { has_reform = fascist_government }
							NOT = { has_reform = military_government }
							NOT = { has_reform = presidential_despot_reform }
						}
					}
					# Communist Government Type
					AND = {
						OR = {
							has_reform = peasants_republic
							has_reform = communist_government
						}
						FROM = {
							NOT = { has_reform = peasants_republic }
							NOT = { has_reform = communist_government }
						}
					}
					# Capitalist Government Type
					AND = {
						OR = {
							has_reform = administrative_monarchy
							has_reform = constitutional_monarchy
							has_reform = merchants_reform
							has_reform = oligarchy_reform
							has_reform = administrative_republic
							has_reform = constitutional_republic
							has_reform = bureaucratic_despotism
							has_reform = english_monarchy
							has_reform = trading_city
							has_reform = dutch_republic
							has_reform = american_republic
							has_reform = federal_republic
						}
						FROM = {
							NOT = { has_reform = administrative_monarchy }
							NOT = { has_reform = constitutional_monarchy }
							NOT = { has_reform = merchants_reform }
							NOT = { has_reform = oligarchy_reform }
							NOT = { has_reform = administrative_republic }
							NOT = { has_reform = constitutional_republic }
							NOT = { has_reform = bureaucratic_despotism }
							NOT = { has_reform = english_monarchy }
							NOT = { has_reform = trading_city }
							NOT = { has_reform = dutch_republic }
							NOT = { has_reform = american_republic }
							NOT = { has_reform = federal_republic }
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = NOT_RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 200
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 200
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 190
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 200
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 190
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 180
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 190
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 180
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 170
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 180
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 170
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 160
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 170
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 160
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 150
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 160
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 150
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 140
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 150
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 140
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 130
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 140
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 130
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 120
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 130
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 120
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 110
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 120
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 110
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 100
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 110
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 90
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 100
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 80
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 90
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 80
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 70
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 80
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 70
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 60
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 70
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 50
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 60
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 40
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 30
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 40
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 20
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
						value = 10
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 20
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = RELEASED_FROM_IN_A_WAR
			limit = {
				FROM = {
					has_opinion_modifier = {
						modifier = released_in_peace
						who = ROOT
					}
					NOT = {
						has_opinion_modifier = {
							modifier = released_in_peace
							who = ROOT
							value = 10
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1
			}
		}
		add_entry = {
			name = OPINION
			export_to_variable = {
				which = ai_value
				value = opinion
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = 4 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = modifier:diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = FROM_HAS_AT_LEAST_HALF_OF_ROOT_TOTAL_DEVELOPMENT
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					divide_variable = { which = our_total_development value = 2 }
					
					check_variable = { which = their_total_development which = our_total_development }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				any_country = {
					is_subject_of = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			multiply_variable = { which = ai_value value = -0.5 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					NOT = { check_variable = { which = military_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = -49 }
					NOT = { check_variable = { which = military_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = trigger_value:mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = trigger_value:mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = -49 }
					NOT = { check_variable = { which = eco_power value = 50 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					NOT = { check_variable = { which = eco_power value = -49 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = 50 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 50
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_puppet_state_@ROOT }
				had_country_flag = { flag = declined_establish_puppet_state_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
		}
		is_revolution_target = no
		OR = {
			is_neighbor_of = FROM
			any_rival_country = {
				is_neighbor_of = FROM
			}
		}
		OR = {
			NOT = { great_power_rank = 4 }
			tag = USA
			tag = ENG
			tag = GBR
			tag = RUS
			tag = SOV
			# Fascist Government Type
			has_reform = fascist_government
			has_reform = military_government
			has_reform = presidential_despot_reform
			# Communist Government Type
			has_reform = peasants_republic
			has_reform = peasants_republic_legacy
			has_reform = communist_government
			# Capitalist Government Type
			has_reform = administrative_monarchy
			has_reform = constitutional_monarchy
			has_reform = merchants_reform
			has_reform = oligarchy_reform
			has_reform = administrative_republic
			has_reform = constitutional_republic
			has_reform = bureaucratic_despotism
			has_reform = english_monarchy
			has_reform = trading_city
			has_reform = dutch_republic
			has_reform = american_republic
			has_reform = federal_republic
		}
	}
}

cancel_puppet_state = {
	category = influence
	
	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = puppet_state
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = puppet_state
			}
		}
		is_at_war = no
		FROM = { is_at_war = no }
		NOT = { truce_with = FROM }
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = puppet_state
				}
				is_at_war = no
				FROM = { is_at_war = no }
				NOT = { truce_with = FROM }
			}
			if = {
				limit = {
					NOT = { full_idea_group = diplomatic_ideas }
				}
				add_stability = -1
			}
			add_prestige = -20
			FROM = {
				grant_independence = yes
				country_event = { id = subjects_expanded_puppet_state_events.2 }
				country_event = { id = subjects_expanded_puppet_state_events.3 }
				add_opinion = {
					who = ROOT
					modifier = released_puppet_state
				}
			}
			add_truce_with = FROM
		}
	}
	
	ai_will_do = {
		OR = {
			stability = 1
			adm_power = 300
			full_idea_group = diplomatic_ideas
		}
		NOT = {
			OR = {
				total_development = 300
				NOT = { great_power_rank = 4 }
				tag = USA
				tag = ENG
				tag = GBR
				tag = RUS
				tag = SOV
				# Fascist Government Type
				has_reform = fascist_government
				has_reform = military_government
				has_reform = presidential_despot_reform
				# Communist Government Type
				has_reform = peasants_republic
				has_reform = communist_government
				# Capitalist Government Type
				has_reform = administrative_monarchy
				has_reform = constitutional_monarchy
				has_reform = merchants_reform
				has_reform = oligarchy_reform
				has_reform = administrative_republic
				has_reform = constitutional_republic
				has_reform = bureaucratic_despotism
				has_reform = english_monarchy
				has_reform = trading_city
				has_reform = dutch_republic
				has_reform = american_republic
				has_reform = federal_republic
			}
		}
	}
}

increase_colonial_autonomy = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		num_of_colonists = 1
		OR = {
			AND = {
				FROM = { is_subject_of_type = colony }
				can_create_subject_type = {
					subject = FROM
					subject_type = dominion
				}
			}
			AND = {
				FROM = { is_subject_of_type = dominion }
				can_create_subject_type = {
					subject = FROM
					subject_type = autonomous_dominion
				}
			}
		}
	}
	
	is_allowed = {
		hidden_trigger = {
		num_of_colonists = 1
			OR = {
				AND = {
					FROM = { is_subject_of_type = colony }
					can_create_subject_type = {
						subject = FROM
						subject_type = dominion
					}
				}
				AND = {
					FROM = { is_subject_of_type = dominion }
					can_create_subject_type = {
						subject = FROM
						subject_type = autonomous_dominion
					}
				}
			}
		}
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			liberty_desire = 50
		}
	}
	
	on_accept = {
		if = {
			limit = {
				num_of_colonists = 1
				OR = {
					AND = {
						FROM = { is_subject_of_type = colony }
						can_create_subject_type = {
							subject = FROM
							subject_type = dominion
						}
					}
					AND = {
						FROM = { is_subject_of_type = dominion }
						can_create_subject_type = {
							subject = FROM
							subject_type = autonomous_dominion
						}
					}
				}
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					liberty_desire = 50
				}
			}
			if = {
				limit = {
					FROM = { is_subject_of_type = colony }
				}
				create_subject = {
					subject = FROM
					subject_type = dominion
				}
			}
			else = {
				create_subject = {
					subject = FROM
					subject_type = autonomous_dominion
				}
			}
			FROM = {
				country_event = { id = subjects_expanded_dominion_events.1 }
			}
			add_country_modifier = {
				name = established_autonomous_dominion
				duration = 3650
				hidden = yes
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			is_subject_of_type = colony
		}
		OR = {
			AND = {
				is_random_new_world = no
				tag = GBR
				FROM = {
					capital_scope = {
						colonial_region = colonial_canada
					}
				}
			}
			AND = {
				colony = 3
				NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = autonomous_dominion } amount = 2 } }
				FROM = {
					OR = {
						development_of_overlord_fraction = 0.33
						liberty_desire = 90
					}
				}
				NOT = { has_country_modifier = established_autonomous_dominion }
				OR = {
					tag = GBR
					tag = ENG
					tag = FRA
					tag = FR2
					tag = SPA
					tag = CAS
				}
				# FROM is not best paying colony of ROOT (if liberty_desire is smaller than 50)
				any_subject_country = {
					is_colonial_nation = yes
					NOT = { is_subject_of_type = autonomous_dominion }
					NOT = { tag = FROM }
					variable_arithmetic_trigger = {
						custom_tooltip = FROM_TARIFF_VALUE
						# Export Overlord's Global Tariffs
						export_to_variable = {
							which = overlord_global_tariffs
							value = modifier:global_tariffs
							who = ROOT
						}
						# Export FROM's Monthly Income
						export_to_variable = {
							which = FROM_cn_tariff_value
							value = trigger_value:monthly_income
							who = FROM
						}
						# Export FROM's Tariff Percentage
						export_to_variable = {
							which = FROM_cn_tariff_percentage
							value = trigger_value:tariff_value
							who = FROM
						}
						# Calculate Tariff Efficiency
						variable_arithmetic_trigger = {
							change_variable = { which = overlord_global_tariffs value = 1 }
						}
						multiply_variable = { which = FROM_cn_tariff_percentage which = overlord_global_tariffs }
						# Calculate Payed Money
						multiply_variable = { which = FROM_cn_tariff_value which = FROM_cn_tariff_percentage }
						divide_variable = { which = FROM_cn_tariff_value value = 10 }
						multiply_variable = { which = FROM_cn_tariff_value value = 10 }
						
						# Compare to other Colonies
						export_to_variable = {
							which = cn_tariff_value
							value = trigger_value:monthly_income
						}
						export_to_variable = {
							which = cn_tariff_percentage
							value = trigger_value:tariff_value
						}
						multiply_variable = { which = cn_tariff_percentage which = overlord_global_tariffs }
						multiply_variable = { which = cn_tariff_value which = cn_tariff_percentage }
						divide_variable = { which = cn_tariff_value value = 10 }
						multiply_variable = { which = cn_tariff_value value = 10 }									
						
						check_variable = { which = cn_tariff_value which = FROM_cn_tariff_value }
					}
				}
			}
		}
		NOT = { has_age_ability = ab_industrial_british_empire }
	}
}

demand_manpower_from_autonomous_dominion = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = autonomous_dominion
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = autonomous_dominion
			}
		}
		is_at_war = yes
		FROM = { is_at_war = no }
		FROM = {
			manpower = 5
		}
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_DEMAND_MANPOWER_OF_AUTONOMOUS_DOMINION_WITHIN_LAST_5_YEARS
				NOT = { has_country_modifier = cooldown_demand_manpower_from_autonomous_dominion }
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = autonomous_dominion
				}
				is_at_war = yes
				FROM = { is_at_war = no }
				FROM = {
					manpower = 5
				}
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			add_manpower = 5
			FROM = {
				add_manpower = -5
				add_liberty_desire = 10
				country_event = { id = subjects_expanded_dominion_events.2 }
				add_country_modifier = {
					name = cooldown_demand_manpower_from_autonomous_dominion
					duration = 1825
					hidden = yes
				}
			}
		}
	}
	
	ai_will_do = {
		NOT = { manpower = 1 }
		FROM = {
			manpower = 5
			NOT = { liberty_desire = 40 }
		}
	}
}

decrease_colonial_autonomy = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		num_of_colonists = 1
		FROM = {
			is_subject_of = ROOT
			OR = {
				AND = {
					is_subject_of_type = dominion
					capital_scope = {
						is_node_in_trade_company_region = no
					}
				}
				is_subject_of_type = autonomous_dominion
			}
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			num_of_colonists = 1
			FROM = {
				is_subject_of = ROOT
				OR = {
					AND = {
						is_subject_of_type = dominion
						capital_scope = {
							is_node_in_trade_company_region = no
						}
					}
					is_subject_of_type = autonomous_dominion
				}
			}
		}
		FROM = {
			capital_scope = { trade_range = ROOT }
		}
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = {
			NOT = { liberty_desire = 50 }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				num_of_colonists = 1
				FROM = {
					is_subject_of = ROOT
					OR = {
						AND = {
							is_subject_of_type = dominion
							capital_scope = {
								is_node_in_trade_company_region = no
							}
						}
						is_subject_of_type = autonomous_dominion
					}
				}
				FROM = {
					capital_scope = { trade_range = ROOT }
				}
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = {
					NOT = { liberty_desire = 50 }
				}
			}
			if = {
				limit = {
					FROM = { is_subject_of_type = autonomous_dominion }
				}
				create_subject = {
					subject = FROM
					subject_type = dominion
				}
			}
			else = {
				create_subject = {
					subject = FROM
					subject_type = colony
				}
			}
			FROM = {
				add_liberty_desire = 25
			}
		}
	}
	
	ai_will_do = {
		always = no
	}
}

establish_roman_client_kingdom = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = roman_client_kingdom
		}
		FROM = {
			is_subject_of = PREV
			is_vassal_or_similar_subject = yes
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = roman_client_kingdom
		}
		FROM = {
			is_subject_of = PREV
			is_vassal_or_similar_subject = yes
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = roman_client_kingdom
				}
				FROM = {
					is_subject_of = PREV
					is_vassal_or_similar_subject = yes
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = roman_client_kingdom
			}
		}
	}
	
	ai_will_do = {
		NOT = { num_of_diplomatic_relations = 3 }
		NOT = { num_of_free_diplomatic_relations = 0 }
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = roman_client_kingdom } amount = 5 } }
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

place_roman_ruler_on_subject_throne = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		OR = {
			tag = ROM
			tag = ROW
			tag = BYZ
		}
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
			government = monarchy
			has_regency = no
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			OR = {
				tag = ROM
				tag = ROW
				tag = BYZ
			}
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
				government = monarchy
				has_regency = no
			}
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_REPLACE_CURRENT_RULER
				NOT = { has_ruler_flag = placed_on_throne_by_@ROOT }
			}
		}
		custom_trigger_tooltip = {
			tooltip = DID_NOT_REPLACE_RULER_WITHIN_LAST_50_YEARS
			NOT = { has_country_modifier = cooldown_placed_roman_ruler_on_subject_throne }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				OR = {
					tag = ROM
					tag = ROW
					tag = BYZ
				}
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
					government = monarchy
					has_regency = no
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_ruler_flag = placed_on_throne_by_@ROOT }
				}
				NOT = { has_country_modifier = cooldown_placed_roman_ruler_on_subject_throne }
			}
			FROM = {
				define_ruler = {
					culture = ROOT
					religion = ROOT
					male = yes
				}
				if = {
					limit = {
						has_heir = yes
					}
					kill_heir = yes
				}
				add_liberty_desire = 10
				set_ruler_flag = placed_on_throne_by_@ROOT
				add_opinion = {
					who = ROOT
					modifier = roman_client_kingdom_replaced_ruler
				}
			}
			add_country_modifier = {
				name = cooldown_placed_roman_ruler_on_subject_throne
				duration = 18250
				hidden = yes
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			months_of_ruling = 60
			NOT = { marriage_with = ROOT }
			NOT = { dynasty = ROOT }
			NOT = { ruler_culture = ROOT }
			OR = {
				AND = {
					has_heir = no
					NOT = { legitimacy = 50 }
				}
				AND = {
					is_female = yes
					ROOT = { is_female = no }
				}
			}
		}
	}
}

demand_additional_tribute_from_roman_client_kingdom = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		OR = {
			tag = ROM
			tag = ROW
			tag = BYZ
		}
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			OR = {
				tag = ROM
				tag = ROW
				tag = BYZ
			}
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
			}
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				OR = {
					tag = ROM
					tag = ROW
					tag = BYZ
				}
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			FROM = {
				country_event = { id = subjects_expanded_roman_client_kingdom_events.3 }
			}
		}
	}
	
	ai_will_do = {
		always = no
	}
}

cancel_roman_client_kingdom = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = roman_client_kingdom
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = roman_client_kingdom
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = roman_client_kingdom
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		always = no
	}
}

establish_voivodeship = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = voivodeship
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = voivodeship
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = voivodeship
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			create_subject = {
				subject = FROM
				subject_type = voivodeship
			}
		}
	}
	
	ai_will_do = {
		is_emperor = no
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = voivodeship } amount = 5 } }
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

cancel_voivodeship = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = voivodeship
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = voivodeship
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = voivodeship
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		always = no
	}
}

establish_fief_subject = {
	category = influence
	
	alert_index = 6
	alert_tooltip = establish_fief_subject_alert_tooltip
	
	require_acceptance = yes
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = fief_subject
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = fief_subject
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		if = {
			limit = {
				FROM = {
					NOT = { is_subject_of = ROOT }
				}
			}
			FROM = {
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
			alliance_with = FROM
			FROM = {
				NOT = { total_development = 100 }
			}
		}
		else = {
			FROM = {
				NOT = { liberty_desire = 50 }
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = fief_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					FROM = {
						has_opinion = {
							who = ROOT
							value = 150
						}
					}
					alliance_with = FROM
					FROM = {
						NOT = { total_development = 100 }
					}
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			create_subject = {
				subject = FROM
				subject_type = fief_subject
			}
		}
	}
	
	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = fief_subject
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				if = {
					limit = {
						FROM = {
							NOT = { is_subject_of = ROOT }
						}
					}
					FROM = {
						has_opinion = {
							who = ROOT
							value = 150
						}
					}
					alliance_with = FROM
					FROM = {
						NOT = { total_development = 100 }
					}
				}
				else = {
					FROM = {
						NOT = { liberty_desire = 50 }
					}
				}
			}
			FROM = {
				clr_country_flag = declined_establish_fief_subject_@ROOT
				set_country_flag = declined_establish_fief_subject_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_fief_subject_opinion
			}
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = FROM_IS_VASSAL_OF_ROOT
			limit = {
				overlord_of = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
		}
		add_entry = {
			name = FROM_LIBERTY_DESIRE_TOO_HIGH
			limit = {
				overlord_of = FROM
				FROM = {
					liberty_desire = 50
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				NOT = { overlord_of = FROM }
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = government_rank
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { overlord_of = FROM }
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				NOT = { overlord_of = FROM }
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					has_reform = merchants_reform
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_IS_MERCHANT_REPUBLIC
			limit = {
				NOT = { overlord_of = FROM }
				has_reform = merchants_reform
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = trigger_value:mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = trigger_value:mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				NOT = { overlord_of = FROM }
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_100_TOTAL_DEVELOPMENT
			limit = {
				NOT = { overlord_of = FROM }
				FROM = {
					total_development = 100
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				NOT = { overlord_of = FROM }
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				NOT = { overlord_of = FROM }
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = ROOT_FROM_HAVE_SAME_PRIMARY_CULTURE
			limit = {
				NOT = { overlord_of = FROM }
				primary_culture = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
		}
	}
	
	ai_will_do = {
		is_emperor = no
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = fief_subject } amount = 5 } }
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_fief_subject_@ROOT }
				had_country_flag = { flag = declined_establish_fief_subject_@ROOT days = 1825 }
			}
			NOT = { is_subject_of = ROOT }
		}
	}
}

demand_troops_from_fief_subject = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = fief_subject
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = fief_subject
			}
		}
		FROM = {
			is_at_war = no
		}
		FROM = {
			num_of_infantry = 10
		}
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			custom_trigger_tooltip = {
				tooltip = DID_NOT_DEMAND_TROOPS_OF_FIEF_WITHIN_LAST_10_YEARS
				NOT = { has_country_modifier = cooldown_demand_troops_from_fief_subject }
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = fief_subject
				}
				FROM = {
					is_at_war = no
				}
				FROM = {
					num_of_infantry = 10
				}
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_country_modifier = cooldown_demand_troops_from_fief_subject }
				}
			}
			capital_scope = {
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
				infantry = ROOT
			}
			FROM = {
				add_liberty_desire = 10
				add_country_modifier = {
					name = cooldown_demand_troops_from_fief_subject
					duration = 1825
					hidden = yes
				}
				country_event = { id = subjects_expanded_fief_subject_events.1 }
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
			random_province = {
				limit = {
					infantry_in_province = FROM
				}
				kill_units = {
					who = FROM
					type = infantry
					amount = 1
				}
			}
		}
	}
	
	ai_will_do = {
		is_at_war = yes
		NOT = { manpower = 1 }
		NOT = { army_size = 30 }
		FROM = {
			NOT = { liberty_desire = 40 }
		}
		NOT = {
			calc_true_if = {
				all_subject_country = {
					has_country_modifier = cooldown_demand_troops_from_fief_subject
				}
				amount = 2
			}
		}
	}
}

cancel_fief_subject = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = fief_subject
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = fief_subject
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = fief_subject
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		always = no
	}
}

establish_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = crusader_state_vassal
		}
		if = {
			limit = {
				tag = PAP
			}
			OR = {
				any_country = {
					is_crusade_target = yes
				}
				is_papal_controller = yes
				religious_unity = 1
			}
		}
		else = {
			papal_influence = 20
		}
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			variable_arithmetic_trigger = {
				custom_tooltip = HAS_LESS_THAN_HALF_OF_PREV_TOTAL_DEVELOPMENT
				export_to_variable = {
					which = our_total_dev
					value = trigger_value:total_development
				}
				subtract_variable = { which = our_total_dev value = 1 }
				export_to_variable = {
					which = their_total_dev
					value = trigger_value:total_development
					who = PREV
				}
				subtract_variable = { which = their_total_dev value = 1 }
				divide_variable = { which = their_total_dev value = 2 }
				NOT = { check_variable = { which = our_total_dev which = their_total_dev } }
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = crusader_state_vassal
				}
				if = {
					limit = {
						tag = PAP
					}
					OR = {
						any_country = {
							is_crusade_target = yes
						}
						is_papal_controller = yes
						religious_unity = 1
					}
				}
				else = {
					papal_influence = 20
				}
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			if = {
				limit = {
					NOT = { tag = PAP }
				}
				add_papal_influence = -20
			}
			create_subject = {
				subject = FROM
				subject_type = crusader_state_vassal
			}
		}
	}
	
	ai_will_do = {
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
		any_country = {
			is_crusade_target = yes
		}
	}
}

send_crusader_knights_to_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		religion = catholic
		FROM = {
			religion = catholic
			is_subject_of = ROOT
			is_subject_of_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			religion = catholic
			FROM = {
				religion = catholic
				is_subject_of = ROOT
				is_subject_of_type = crusader_state_vassal
			}
		}
		manpower = 1
		treasury = 500
		FROM = {
			is_at_war = yes
		}
		FROM = { NOT = { liberty_desire = 50 } }
		FROM = {
			NOT = { has_country_modifier = send_crusader_knights_to_crusader_state_vassal }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				religion = catholic
				FROM = {
					religion = catholic
					is_subject_of = ROOT
					is_subject_of_type = crusader_state_vassal
				}
				FROM = {
					is_at_war = yes
				}
				FROM = { NOT = { liberty_desire = 50 } }
				FROM = {
					NOT = { has_country_modifier = send_crusader_knights_to_crusader_state_vassal }
				}
			}
			add_manpower = -1
			add_treasury = -500
			FROM = {
				add_manpower = 1
				add_treasury = 500
				add_country_modifier = {
					name = send_crusader_knights_to_crusader_state_vassal
					duration = 1825
				}
			}
		}
	}
	
	ai_will_do = {
		crusade_target = {
			war_with = FROM
		}
		manpower = 10000
		treasury = 1500
	}
}

invite_missionars_from_crusader_state_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		religion = catholic
		FROM = {
			religion = catholic
			is_subject_of = ROOT
			is_subject_of_type = crusader_state_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			religion = catholic
			FROM = {
				religion = catholic
				is_subject_of = ROOT
				is_subject_of_type = crusader_state_vassal
			}
		}
		treasury = 1000
		is_at_war = no
		NOT = { num_of_missionaries = 4 }
		NOT = { has_country_modifier = invite_missionars_from_crusader_state_vassal }
		FROM = {
			is_at_war = no
		}
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				religion = catholic
				FROM = {
					religion = catholic
					is_subject_of = ROOT
					is_subject_of_type = crusader_state_vassal
				}
				treasury = 1000
				is_at_war = no
				NOT = { num_of_missionaries = 4 }
				NOT = { has_country_modifier = invite_missionars_from_crusader_state_vassal }
				FROM = {
					is_at_war = no
				}
				FROM = { NOT = { liberty_desire = 50 } }
			}
			add_treasury = -1000
			add_country_modifier = {
				name = invite_missionars_from_crusader_state_vassal
				duration = 1825
			}
			FROM = {
				add_treasury = 1000
				add_liberty_desire = 25
			}
		}
	}
	
	ai_will_do = {
		treasury = 2000
		NOT = { num_of_missionaries = 3 }
		FROM = {
			NOT = { liberty_desire = 25 }
		}
		NOT = { religious_unity = 0.5 }
	}
}

establish_nahuatl_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = nahuatl_vassal
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = nahuatl_vassal
		}
		NOT = { doom = 90 }
		NOT = { truce_with = FROM }
		is_at_war = no
		FROM = { is_at_war = no }
		FROM = { NOT = { liberty_desire = 50 } }
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = nahuatl_vassal
				}
				NOT = { doom = 90 }
				NOT = { truce_with = FROM }
				is_at_war = no
				FROM = { is_at_war = no }
				FROM = { NOT = { liberty_desire = 50 } }
			}
			add_doom = 10
			create_subject = {
				subject = FROM
				subject_type = nahuatl_vassal
			}
		}
	}
	
	ai_will_do = {
		NOT = { doom = 50 }
		FROM = {
			NOT = {
				years_in_vassalage_under = {
					who = ROOT
					years = 10
					all_subject_country = yes
				}
			}
		}
	}
}

establish_peasant_vassal = {
	category = influence
	
	alert_index = 6
	alert_tooltip = establish_peasant_vassal_alert_tooltip
	
	require_acceptance = yes
	
	is_visible = {
		can_create_subject_type = {
			subject = FROM
			subject_type = peasant_vassal
		}
	}
	
	is_allowed = {
		can_create_subject_type = {
			subject = FROM
			subject_type = peasant_vassal
		}
		is_at_war = no
		FROM = {
			is_at_war = no
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 165
			}
		}
		alliance_with = FROM
		FROM = {
			NOT = { total_development = 100 }
		}
	}
	
	on_accept = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = peasant_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 165
					}
				}
				alliance_with = FROM
				FROM = {
					NOT = { total_development = 100 }
				}
			}
			create_subject = {
				subject = FROM
				subject_type = peasant_vassal
			}
			FROM = {
				country_event = { id = subjects_expanded_peasant_vassal_events.1 }
				country_event = { id = subjects_expanded_peasant_vassal_events.1 days = 1 }
			}
		}
	}
	
	on_decline = {
		if = {
			limit = {
				can_create_subject_type = {
					subject = FROM
					subject_type = peasant_vassal
				}
				is_at_war = no
				FROM = {
					is_at_war = no
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 165
					}
				}
				alliance_with = FROM
				FROM = {
					NOT = { total_development = 100 }
				}
			}
			FROM = {
				clr_country_flag = declined_establish_peasant_vassal_@ROOT
				set_country_flag = declined_establish_peasant_vassal_@ROOT
			}
			add_opinion = {
				who = FROM
				modifier = declined_establish_peasant_vassal_opinion
			}
		}
	}
	
	ai_acceptance = {
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_allied }
						ai_attitude = { who = ROOT attitude = attitude_friendly }
						ai_attitude = { who = ROOT attitude = attitude_threatened }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					ai_attitude = { who = ROOT attitude = attitude_neutral }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_ATTITUDE_TOWARDS_ROOT
			limit = {
				FROM = {
					OR = {
						ai_attitude = { who = ROOT attitude = attitude_hostile }
						ai_attitude = { who = ROOT attitude = attitude_outraged }
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 100
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MARRIAGE_WITH_ROOT
			limit = {
				marriage_with = FROM
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 50
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			divide_variable = { which = ai_value value = 5 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					trust = {
						who = ROOT
						value = 30
					}
					NOT = {
						trust = {
							who = ROOT
							value = 50
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = trust
				who = FROM
				with = ROOT
			}
			subtract_variable = { which = ai_value value = 50 }
			multiply_variable = { which = ai_value value = 2 }
		}
		add_entry = {
			name = TRUST
			limit = {
				FROM = {
					NOT = {
						trust = {
							who = ROOT
							value = 30
						}
					}
				}
			}
			export_to_variable = {
				which = ai_value
				value = 2000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = MODIFIER_DIPLO_SKILL
			export_to_variable = {
				which = ai_value
				value = diplomatic_reputation
			}
			multiply_variable = { which = ai_value value = 3 }
		}
		add_entry = {
			name = ROOT_FROM_DIFF_OF_GOV_RANKS
			limit = {
				NOT = { overlord_of = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = government_rank
			}
			export_to_variable = {
				which = ai_value_2
				value = government_rank
				who = FROM
			}
			subtract_variable = { which = ai_value which = ai_value_2 }
			multiply_variable = { which = ai_value value = 10 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION_GROUP
			limit = {
				NOT = { religion_group = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 20
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_NOT_SAME_RELIGION
			limit = {
				religion_group = FROM
				NOT = { religion = FROM }
			}
			export_to_variable = {
				which = ai_value
				value = 10
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					NOT = { check_variable = { which = military_power value = -39 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 40
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = -39 }
					NOT = { check_variable = { which = military_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 0
			}
			export_to_variable = {
				which = our_mil_tech
				value = trigger_value:mil_tech
			}
			export_to_variable = {
				which = their_mil_tech
				value = trigger_value:mil_tech
				who = FROM
			}
			export_to_variable = {
				which = our_army_size
				value = trigger_value:army_size
			}
			export_to_variable = {
				which = their_army_size
				value = trigger_value:army_size
				who = FROM
			}
			divide_variable = { which = our_army_size value = 10 }
			divide_variable = { which = their_army_size value = -10 }
			change_variable = { which = our_army_size which = their_army_size }
			multiply_variable = { which = their_mil_tech value = -1 }
			change_variable = { which = our_mil_tech which = their_mil_tech }
			multiply_variable = { which = our_mil_tech value = 3 }
			change_variable = { which = ai_value which = our_army_size }
			change_variable = { which = ai_value which = our_mil_tech }
		}
		add_entry = {
			name = ROOT_FROM_MILITARY_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = our_mil_tech
						value = trigger_value:mil_tech
					}
					export_to_variable = {
						which = their_mil_tech
						value = trigger_value:mil_tech
						who = FROM
					}
					export_to_variable = {
						which = our_army_size
						value = trigger_value:army_size
					}
					export_to_variable = {
						which = their_army_size
						value = trigger_value:army_size
						who = FROM
					}
					export_to_variable = {
						which = military_power
						value = 0
					}
					divide_variable = { which = our_army_size value = 10 }
					divide_variable = { which = their_army_size value = -10 }
					change_variable = { which = our_army_size which = their_army_size }
					multiply_variable = { which = their_mil_tech value = -1 }
					variable_arithmetic_trigger = {
						change_variable = { which = our_mil_tech which = their_mil_tech }
					}
					multiply_variable = { which = our_mil_tech value = 3 }
					variable_arithmetic_trigger = {
						change_variable = { which = military_power which = our_army_size }
					}
					variable_arithmetic_trigger =  {
						change_variable = { which = military_power which = our_mil_tech }
					}
					
					check_variable = { which = military_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = no
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 75
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_MEMBER
			limit = {
				is_part_of_hre = yes
				FROM = {
					is_part_of_hre = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 25
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_HRE_ELECTOR
			limit = {
				FROM = {
					is_elector = yes
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_SUBJECTS
			limit = {
				FROM = {
					num_of_subjects = 1
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_IS_PAPAL_STATE
			limit = {
				FROM = {
					tag = PAP
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = FROM_HAS_MORE_THAN_100_TOTAL_DEVELOPMENT
			limit = {
				FROM = {
					total_development = 100
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_OWNS_FROM_CORE_PROVINCES
			limit = {
				any_owned_province = {
					is_core = FROM
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = BORDER_DISTANCE
			export_to_variable = {
				which = ai_value
				value = border_distance
				who = FROM
				with = ROOT
			}
			divide_variable = { which = ai_value value = -2 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = -89 }
					NOT = { check_variable = { which = eco_power value = 30 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 60
			}
			export_to_variable = {
				which = our_total_development
				value = trigger_value:total_development
			}
			export_to_variable = {
				which = their_total_development
				value = trigger_value:total_development
				who = FROM
			}
			multiply_variable = { which = their_total_development which = their_total_development }
			divide_variable = { which = our_total_development which = their_total_development }
			multiply_variable = { which = ai_value which = our_total_development }
			change_variable = { which = ai_value value = -90 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					NOT = { check_variable = { which = eco_power value = -89 } }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 90
			}
			multiply_variable = { which = ai_value value = -1 }
		}
		add_entry = {
			name = ROOT_FROM_ECONOMIC_POWER_COMPARED
			limit = {
				variable_arithmetic_trigger = {
					export_to_variable = {
						which = eco_power
						value = 60
					}
					export_to_variable = {
						which = our_total_development
						value = trigger_value:total_development
					}
					export_to_variable = {
						which = their_total_development
						value = trigger_value:total_development
						who = FROM
					}
					multiply_variable = { which = their_total_development which = their_total_development }
					divide_variable = { which = our_total_development which = their_total_development }
					multiply_variable = { which = eco_power which = our_total_development }
					change_variable = { which = eco_power value = -90 }
					
					check_variable = { which = eco_power value = 30 }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_PEASANTS_REPUBLIC
			limit = {
				FROM = {
					has_reform = peasants_republic
				}
			}
			export_to_variable = {
				which = ai_value
				value = 30
			}
		}
		add_entry = {
			name = FROM_IS_NOT_PEASANTS_REPUBLIC
			limit = {
				FROM = {
					NOT = { has_reform = peasants_republic }
				}
			}
			export_to_variable = {
				which = ai_value
				value = 1000
			}
			multiply_variable = { which = ai_value value = -1 }
		}
	}
	
	ai_will_do = {
		has_global_modifier_value = {
			which = global_tax_income
			value = 2
		}
		monthly_income = 5
		NOT = { calc_true_if = { all_subject_country = { is_subject_of_type = peasant_vassal } amount = 5 } }
		FROM = {
			OR = {
				NOT = { has_country_flag = declined_establish_peasant_vassal_@ROOT }
				had_country_flag = { flag = declined_establish_peasant_vassal_@ROOT days = 1825 }
			}
		}
	}
}

cancel_peasant_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			is_subject_of_type = peasant_vassal
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				is_subject_of_type = peasant_vassal
			}
		}
		NOT = { truce_with = FROM }
		prestige = 0
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					is_subject_of_type = peasant_vassal
				}
				NOT = { truce_with = FROM }
				prestige = 0
			}
			FROM = {
				if = {
					limit = {
						NOT = { liberty_desire = 50 }
					}
					add_opinion = {
						who = ROOT
						modifier = vassal_abandoned
					}
				}
				grant_independence = yes
				add_truce_with = ROOT
			}
			add_truce_with = FROM
			add_prestige = -25
		}
	}
	
	ai_will_do = {
		always = no
	}
}

# Return to Vassal
return_subject_to_vassal = {
	category = influence

	require_acceptance = no
	
	is_visible = {
		FROM = {
			is_subject_of = ROOT
			OR = {
				is_similar_vassal_subject = yes
				is_similar_march_subject = yes
			}
		}
	}
	
	is_allowed = {
		hidden_trigger = {
			FROM = {
				is_subject_of = ROOT
				OR = {
					is_similar_vassal_subject = yes
					is_similar_march_subject = yes
				}
			}
		}
		prestige = 0
		FROM = {
			NOT = { liberty_desire = 50 }
		}
		FROM = {
			has_opinion = {
				who = ROOT
				value = 100
			}
		}
	}
	
	on_accept = {
		if = {
			limit = {
				FROM = {
					is_subject_of = ROOT
					OR = {
						is_similar_vassal_subject = yes
						is_similar_march_subject = yes
					}
				}
				prestige = 0
				FROM = {
					NOT = { liberty_desire = 50 }
				}
				FROM = {
					has_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			FROM = {
				add_opinion = {
					who = ROOT
					modifier = returned_to_vassal
				}
				grant_independence = yes
			}
			vassalize = FROM
			add_prestige = -10
			FROM = {
				add_liberty_desire = 25
			}
		}
	}
	
	ai_will_do = {
		always = no
	}
}